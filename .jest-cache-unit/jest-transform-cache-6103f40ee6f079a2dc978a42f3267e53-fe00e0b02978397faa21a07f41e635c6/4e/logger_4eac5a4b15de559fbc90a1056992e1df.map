{"version":3,"names":["fs","require","promises","path","Logger","constructor","options","level","process","env","LOG_LEVEL","format","logDir","join","cwd","maxFileSize","maxFiles","enableConsole","component","levels","error","warn","info","debug","trace","currentLevel","logQueue","isWriting","initializeLogger","mkdir","recursive","console","log","formatMessage","message","meta","timestamp","Date","toISOString","baseLog","pid","JSON","stringify","metaStr","Object","keys","length","toUpperCase","shouldLog","writeToFile","formattedMessage","fileName","filePath","rotateLogFileIfNeeded","appendFile","stats","stat","size","rotateLogFile","code","dir","dirname","ext","extname","basename","i","oldFile","newFile","access","unlink","rename","rotatedFile","consoleMethod","push","processLogQueue","shift","logWebhookReceived","event","deliveryId","repository","headers","userAgent","contentLength","logWebhookProcessed","processingTime","success","errorStack","stack","logWebhookRetry","attempt","maxAttempts","nextRetryDelay","logWebhookPermanentFailure","attempts","logServiceError","service","operation","context","errorCode","logWebhookSetup","webhook","webhookId","id","webhookUrl","config","url","webhookEvents","events","logAlert","type","severity","details","alertType","logPerformanceMetric","duration","logHealthCheck","status","logShutdown","reason","child","additionalContext","ChildLogger","getLogStats","files","totalSize","oldestLog","newestLog","readdir","file","endsWith","name","created","birthtime","modified","mtime","parentLogger","parent","defaultLogger","createLogger","module","exports","logger"],"sources":["logger.js"],"sourcesContent":["const fs = require('fs').promises;\nconst path = require('path');\n\nclass Logger {\n  constructor(options = {}) {\n    this.options = {\n      level: options.level || process.env.LOG_LEVEL || 'info',\n      format: options.format || 'json',\n      logDir: options.logDir || path.join(process.cwd(), 'logs'),\n      maxFileSize: options.maxFileSize || 10 * 1024 * 1024, // 10MB\n      maxFiles: options.maxFiles || 5,\n      enableConsole: options.enableConsole !== false,\n      component: options.component || 'webhook-system',\n      ...options\n    };\n\n    this.levels = {\n      error: 0,\n      warn: 1,\n      info: 2,\n      debug: 3,\n      trace: 4\n    };\n\n    this.currentLevel = this.levels[this.options.level] || this.levels.info;\n    this.logQueue = [];\n    this.isWriting = false;\n\n    this.initializeLogger();\n  }\n\n  async initializeLogger() {\n    try {\n      await fs.mkdir(this.options.logDir, { recursive: true });\n      console.log(`ðŸ“ Logger initialized: ${this.options.logDir}`);\n    } catch (error) {\n      console.error('Failed to initialize logger:', error);\n    }\n  }\n\n  formatMessage(level, message, meta = {}) {\n    const timestamp = new Date().toISOString();\n    const baseLog = {\n      timestamp,\n      level,\n      component: this.options.component,\n      message,\n      pid: process.pid,\n      ...meta\n    };\n\n    if (this.options.format === 'json') {\n      return JSON.stringify(baseLog);\n    } else {\n      const metaStr = Object.keys(meta).length > 0 ? ` ${JSON.stringify(meta)}` : '';\n      return `${timestamp} [${level.toUpperCase()}] [${this.options.component}] ${message}${metaStr}`;\n    }\n  }\n\n  shouldLog(level) {\n    return this.levels[level] <= this.currentLevel;\n  }\n\n  async writeToFile(level, formattedMessage) {\n    if (!this.shouldLog(level)) return;\n\n    const fileName = `${this.options.component}-${level}.log`;\n    const filePath = path.join(this.options.logDir, fileName);\n\n    try {\n      await this.rotateLogFileIfNeeded(filePath);\n      await fs.appendFile(filePath, formattedMessage + '\\n');\n    } catch (error) {\n      console.error('Failed to write to log file:', error);\n    }\n  }\n\n  async rotateLogFileIfNeeded(filePath) {\n    try {\n      const stats = await fs.stat(filePath);\n      if (stats.size > this.options.maxFileSize) {\n        await this.rotateLogFile(filePath);\n      }\n    } catch (error) {\n      // File doesn't exist yet, no rotation needed\n      if (error.code !== 'ENOENT') {\n        console.error('Error checking log file size:', error);\n      }\n    }\n  }\n\n  async rotateLogFile(filePath) {\n    const dir = path.dirname(filePath);\n    const ext = path.extname(filePath);\n    const basename = path.basename(filePath, ext);\n\n    try {\n      // Rotate existing files\n      for (let i = this.options.maxFiles - 1; i > 0; i--) {\n        const oldFile = path.join(dir, `${basename}.${i}${ext}`);\n        const newFile = path.join(dir, `${basename}.${i + 1}${ext}`);\n        \n        try {\n          await fs.access(oldFile);\n          if (i === this.options.maxFiles - 1) {\n            await fs.unlink(oldFile);\n          } else {\n            await fs.rename(oldFile, newFile);\n          }\n        } catch (error) {\n          // File doesn't exist, skip\n        }\n      }\n\n      // Move current file to .1\n      const rotatedFile = path.join(dir, `${basename}.1${ext}`);\n      await fs.rename(filePath, rotatedFile);\n    } catch (error) {\n      console.error('Error rotating log file:', error);\n    }\n  }\n\n  async log(level, message, meta = {}) {\n    if (!this.shouldLog(level)) return;\n\n    const formattedMessage = this.formatMessage(level, message, meta);\n\n    // Console output\n    if (this.options.enableConsole) {\n      const consoleMethod = level === 'error' ? console.error : \n                           level === 'warn' ? console.warn : console.log;\n      consoleMethod(formattedMessage);\n    }\n\n    // File output\n    this.logQueue.push({ level, message: formattedMessage });\n    await this.processLogQueue();\n  }\n\n  async processLogQueue() {\n    if (this.isWriting || this.logQueue.length === 0) return;\n\n    this.isWriting = true;\n    try {\n      while (this.logQueue.length > 0) {\n        const { level, message } = this.logQueue.shift();\n        await this.writeToFile(level, message);\n      }\n    } finally {\n      this.isWriting = false;\n    }\n  }\n\n  // Convenience methods\n  error(message, meta = {}) {\n    return this.log('error', message, meta);\n  }\n\n  warn(message, meta = {}) {\n    return this.log('warn', message, meta);\n  }\n\n  info(message, meta = {}) {\n    return this.log('info', message, meta);\n  }\n\n  debug(message, meta = {}) {\n    return this.log('debug', message, meta);\n  }\n\n  trace(message, meta = {}) {\n    return this.log('trace', message, meta);\n  }\n\n  // Specialized logging methods for webhooks\n  async logWebhookReceived(event, deliveryId, repository, headers) {\n    await this.info('Webhook received', {\n      event,\n      deliveryId,\n      repository,\n      userAgent: headers['user-agent'],\n      contentLength: headers['content-length'],\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  async logWebhookProcessed(event, deliveryId, repository, processingTime, success, error = null) {\n    const level = success ? 'info' : 'error';\n    const message = success ? 'Webhook processed successfully' : 'Webhook processing failed';\n    \n    await this.log(level, message, {\n      event,\n      deliveryId,\n      repository,\n      processingTime,\n      success,\n      error: error?.message,\n      errorStack: error?.stack,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  async logWebhookRetry(event, deliveryId, repository, attempt, maxAttempts, nextRetryDelay) {\n    await this.warn('Webhook processing retry scheduled', {\n      event,\n      deliveryId,\n      repository,\n      attempt,\n      maxAttempts,\n      nextRetryDelay,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  async logWebhookPermanentFailure(event, deliveryId, repository, attempts, error) {\n    await this.error('Webhook processing permanently failed', {\n      event,\n      deliveryId,\n      repository,\n      attempts,\n      error: error.message,\n      errorStack: error.stack,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  async logServiceError(service, operation, error, context = {}) {\n    await this.error(`Service error: ${service}.${operation}`, {\n      service,\n      operation,\n      error: error.message,\n      errorStack: error.stack,\n      errorCode: error.code,\n      context,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  async logWebhookSetup(repository, success, webhook = null, error = null) {\n    const level = success ? 'info' : 'error';\n    const message = success ? 'Webhook setup successful' : 'Webhook setup failed';\n    \n    await this.log(level, message, {\n      repository,\n      success,\n      webhookId: webhook?.id,\n      webhookUrl: webhook?.config?.url,\n      webhookEvents: webhook?.events,\n      error: error?.message,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  async logAlert(type, severity, message, details = {}) {\n    const level = severity === 'critical' ? 'error' : \n                  severity === 'warning' ? 'warn' : 'info';\n    \n    await this.log(level, `Alert: ${message}`, {\n      alertType: type,\n      severity,\n      details,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  async logPerformanceMetric(operation, duration, success, context = {}) {\n    await this.info('Performance metric', {\n      operation,\n      duration,\n      success,\n      context,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  // Health check logging\n  async logHealthCheck(component, status, details = {}) {\n    const level = status === 'healthy' ? 'info' : \n                  status === 'warning' ? 'warn' : 'error';\n    \n    await this.log(level, `Health check: ${component}`, {\n      component,\n      status,\n      details,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  // Shutdown logging\n  async logShutdown(component, reason = 'Normal shutdown') {\n    await this.info(`Component shutdown: ${component}`, {\n      component,\n      reason,\n      timestamp: new Date().toISOString()\n    });\n    \n    // Ensure all logs are written before shutdown\n    await this.processLogQueue();\n  }\n\n  // Create child logger with additional context\n  child(additionalContext = {}) {\n    return new ChildLogger(this, additionalContext);\n  }\n\n  // Get log statistics\n  async getLogStats() {\n    const stats = {\n      files: [],\n      totalSize: 0,\n      oldestLog: null,\n      newestLog: null\n    };\n\n    try {\n      const files = await fs.readdir(this.options.logDir);\n      \n      for (const file of files) {\n        if (file.endsWith('.log')) {\n          const filePath = path.join(this.options.logDir, file);\n          const stat = await fs.stat(filePath);\n          \n          stats.files.push({\n            name: file,\n            size: stat.size,\n            created: stat.birthtime,\n            modified: stat.mtime\n          });\n          \n          stats.totalSize += stat.size;\n          \n          if (!stats.oldestLog || stat.birthtime < stats.oldestLog) {\n            stats.oldestLog = stat.birthtime;\n          }\n          \n          if (!stats.newestLog || stat.mtime > stats.newestLog) {\n            stats.newestLog = stat.mtime;\n          }\n        }\n      }\n    } catch (error) {\n      await this.error('Failed to get log stats', { error: error.message });\n    }\n\n    return stats;\n  }\n}\n\nclass ChildLogger {\n  constructor(parentLogger, context) {\n    this.parent = parentLogger;\n    this.context = context;\n  }\n\n  async log(level, message, meta = {}) {\n    return this.parent.log(level, message, { ...this.context, ...meta });\n  }\n\n  error(message, meta = {}) {\n    return this.log('error', message, meta);\n  }\n\n  warn(message, meta = {}) {\n    return this.log('warn', message, meta);\n  }\n\n  info(message, meta = {}) {\n    return this.log('info', message, meta);\n  }\n\n  debug(message, meta = {}) {\n    return this.log('debug', message, meta);\n  }\n\n  trace(message, meta = {}) {\n    return this.log('trace', message, meta);\n  }\n\n  child(additionalContext = {}) {\n    return new ChildLogger(this.parent, { ...this.context, ...additionalContext });\n  }\n}\n\n// Create singleton logger instance\nconst defaultLogger = new Logger({\n  component: 'webhook-system',\n  level: process.env.LOG_LEVEL || 'info'\n});\n\n// Factory function for component-specific loggers\nfunction createLogger(component, options = {}) {\n  return new Logger({\n    component,\n    ...options\n  });\n}\n\nmodule.exports = {\n  Logger,\n  ChildLogger,\n  logger: defaultLogger,\n  createLogger\n};"],"mappings":"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","ignoreList":[]}