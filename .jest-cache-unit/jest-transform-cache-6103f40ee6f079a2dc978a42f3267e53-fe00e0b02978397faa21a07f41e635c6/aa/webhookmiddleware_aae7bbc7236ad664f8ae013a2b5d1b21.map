{"version":3,"names":["cov_2c3g0fu61j","actualCoverage","rateLimit","s","require","helmet","ConfigManager","createWebhookRateLimit","config","f","rateLimitConfig","b","api","windowMs","max","message","error","retryAfter","Math","ceil","limit","standardHeaders","legacyHeaders","keyGenerator","req","headers","split","trim","connection","remoteAddress","socket","ip","skip","onLimitReached","res","options","clientIP","console","warn","AuditLogger","logSecurityEvent","timestamp","Date","toISOString","type","ipAddress","userAgent","eventType","delivery","errorCode","createWebhookSecurity","contentSecurityPolicy","directives","defaultSrc","scriptSrc","styleSrc","imgSrc","connectSrc","fontSrc","objectSrc","mediaSrc","frameSrc","hsts","maxAge","includeSubDomains","preload","noSniff","xssFilter","frameguard","action","hidePoweredBy","dnsPrefetchControl","allow","ieNoOpen","referrerPolicy","policy","webhookRequestLogger","next","startTime","now","log","method","path","event","contentLength","originalEnd","end","chunk","encoding","processingTime","statusCode","call","webhookBodySizeValidator","maxSize","parseInt","Error","code","logWebhookError","requestSize","status","json","actualSize","githubEventValidator","loadConfig","process","env","NODE_ENV","allowedEvents","webhook","includes","webhookCORS","allowedOrigins","origin","setHeader","webhookErrorHandler","stackTrace","stack","initializeWebhookMiddleware","loadedConfig","security","requestLogger","bodySizeValidator","eventValidator","cors","errorHandler","module","exports"],"sources":["webhook-middleware.js"],"sourcesContent":["const rateLimit = require('express-rate-limit');\nconst helmet = require('helmet');\nconst { ConfigManager } = require('../config/utils/config-manager');\n\n/**\n * Webhook Middleware\n * \n * Provides security middleware specifically designed for webhook endpoints:\n * - Rate limiting per IP address with configurable windows\n * - Security headers optimized for webhook processing\n * - Request logging and monitoring\n * - IP-based blocking and allowlisting\n */\n\n/**\n * Rate limiting middleware for webhook endpoints\n * More restrictive than general API endpoints to prevent abuse\n */\nconst createWebhookRateLimit = (config) => {\n  const rateLimitConfig = config?.api?.rateLimit || {\n    windowMs: 15 * 60 * 1000, // 15 minutes\n    max: 100 // limit each IP to 100 requests per window\n  };\n\n  return rateLimit({\n    windowMs: rateLimitConfig.windowMs,\n    max: rateLimitConfig.max,\n    message: {\n      error: 'Too many webhook requests from this IP address',\n      retryAfter: Math.ceil(rateLimitConfig.windowMs / 1000),\n      limit: rateLimitConfig.max\n    },\n    standardHeaders: true, // Return rate limit info in `RateLimit-*` headers\n    legacyHeaders: false, // Disable `X-RateLimit-*` headers\n    keyGenerator: (req) => {\n      // Use the real IP address for rate limiting\n      return req.headers['x-forwarded-for']?.split(',')[0]?.trim() ||\n             req.headers['x-real-ip'] ||\n             req.connection?.remoteAddress ||\n             req.socket?.remoteAddress ||\n             req.ip ||\n             'unknown';\n    },\n    skip: (req) => {\n      // Skip rate limiting for ping events (webhook validation)\n      return req.headers['x-github-event'] === 'ping';\n    },\n    onLimitReached: (req, res, options) => {\n      const clientIP = options.keyGenerator(req);\n      console.warn(`Rate limit exceeded for webhook endpoint from IP: ${clientIP}`);\n      \n      // Log rate limit violation for monitoring\n      const { AuditLogger } = require('../utils/audit-logger');\n      AuditLogger.logSecurityEvent({\n        timestamp: new Date().toISOString(),\n        type: 'rate-limit-exceeded',\n        ipAddress: clientIP,\n        userAgent: req.headers['user-agent'],\n        eventType: req.headers['x-github-event'],\n        delivery: req.headers['x-github-delivery'],\n        error: 'Rate limit exceeded for webhook endpoint',\n        errorCode: 'RATE_LIMIT_EXCEEDED'\n      });\n    }\n  });\n};\n\n/**\n * Security headers middleware optimized for webhooks\n */\nconst createWebhookSecurity = () => {\n  return helmet({\n    // Content Security Policy - relaxed for webhook endpoints\n    contentSecurityPolicy: {\n      directives: {\n        defaultSrc: [\"'self'\"],\n        scriptSrc: [\"'none'\"], // No scripts needed for webhook endpoints\n        styleSrc: [\"'none'\"], // No styles needed for webhook endpoints\n        imgSrc: [\"'none'\"], // No images needed for webhook endpoints\n        connectSrc: [\"'none'\"], // No external connections needed\n        fontSrc: [\"'none'\"],\n        objectSrc: [\"'none'\"],\n        mediaSrc: [\"'none'\"],\n        frameSrc: [\"'none'\"]\n      }\n    },\n    \n    // HSTS - Force HTTPS\n    hsts: {\n      maxAge: 31536000, // 1 year\n      includeSubDomains: true,\n      preload: true\n    },\n    \n    // Prevent MIME type sniffing\n    noSniff: true,\n    \n    // Prevent XSS attacks\n    xssFilter: true,\n    \n    // Prevent clickjacking\n    frameguard: { action: 'deny' },\n    \n    // Hide server information\n    hidePoweredBy: true,\n    \n    // Prevent DNS prefetching\n    dnsPrefetchControl: { allow: false },\n    \n    // Prevent IE from executing downloads\n    ieNoOpen: true,\n    \n    // Don't send referrer information\n    referrerPolicy: { policy: 'no-referrer' }\n  });\n};\n\n/**\n * Request logging middleware for webhooks\n */\nconst webhookRequestLogger = (req, res, next) => {\n  const startTime = Date.now();\n  const clientIP = req.headers['x-forwarded-for']?.split(',')[0]?.trim() ||\n                   req.headers['x-real-ip'] ||\n                   req.connection?.remoteAddress ||\n                   req.socket?.remoteAddress ||\n                   req.ip ||\n                   'unknown';\n\n  // Log incoming webhook request\n  console.log(`Webhook request: ${req.method} ${req.path} from ${clientIP}`, {\n    event: req.headers['x-github-event'],\n    delivery: req.headers['x-github-delivery'],\n    userAgent: req.headers['user-agent'],\n    contentLength: req.headers['content-length']\n  });\n\n  // Override res.end to log response\n  const originalEnd = res.end;\n  res.end = function(chunk, encoding) {\n    const processingTime = Date.now() - startTime;\n    \n    console.log(`Webhook response: ${res.statusCode} in ${processingTime}ms`, {\n      event: req.headers['x-github-event'],\n      delivery: req.headers['x-github-delivery'],\n      clientIP,\n      processingTime\n    });\n    \n    originalEnd.call(this, chunk, encoding);\n  };\n\n  next();\n};\n\n/**\n * Request body size validation middleware\n */\nconst webhookBodySizeValidator = (req, res, next) => {\n  const maxSize = 1024 * 1024; // 1MB\n  const contentLength = parseInt(req.headers['content-length'] || '0');\n  \n  if (contentLength > maxSize) {\n    const error = new Error(`Request body too large: ${contentLength} bytes (max: ${maxSize} bytes)`);\n    error.statusCode = 413;\n    error.code = 'REQUEST_TOO_LARGE';\n    \n    // Log the violation\n    const { AuditLogger } = require('../utils/audit-logger');\n    AuditLogger.logWebhookError({\n      eventType: req.headers['x-github-event'],\n      delivery: req.headers['x-github-delivery'],\n      error: error.message,\n      errorCode: error.code,\n      ipAddress: req.ip,\n      userAgent: req.headers['user-agent'],\n      requestSize: contentLength\n    });\n    \n    return res.status(413).json({\n      error: 'Request body too large',\n      maxSize: maxSize,\n      actualSize: contentLength\n    });\n  }\n  \n  next();\n};\n\n/**\n * GitHub event type validation middleware\n */\nconst githubEventValidator = async (req, res, next) => {\n  try {\n    const config = await ConfigManager.loadConfig(process.env.NODE_ENV || 'production');\n    const allowedEvents = config.webhook?.allowedEvents || [\n      'repository_dispatch',\n      'push',\n      'pull_request',\n      'ping'\n    ];\n    \n    const eventType = req.headers['x-github-event'];\n    \n    if (!eventType) {\n      return res.status(400).json({\n        error: 'Missing X-GitHub-Event header',\n        code: 'MISSING_EVENT_HEADER'\n      });\n    }\n    \n    if (!allowedEvents.includes(eventType)) {\n      const error = {\n        error: `Event type '${eventType}' is not allowed`,\n        code: 'INVALID_EVENT_TYPE',\n        allowedEvents\n      };\n      \n      // Log the violation\n      const { AuditLogger } = require('../utils/audit-logger');\n      AuditLogger.logWebhookError({\n        eventType,\n        delivery: req.headers['x-github-delivery'],\n        error: error.error,\n        errorCode: error.code,\n        ipAddress: req.ip,\n        userAgent: req.headers['user-agent']\n      });\n      \n      return res.status(400).json(error);\n    }\n    \n    next();\n  } catch (error) {\n    console.error('Error in GitHub event validator:', error);\n    res.status(500).json({\n      error: 'Internal server error in event validation',\n      code: 'INTERNAL_ERROR'\n    });\n  }\n};\n\n/**\n * CORS middleware specifically for webhook endpoints\n */\nconst webhookCORS = (req, res, next) => {\n  // Webhooks don't need CORS since they're server-to-server\n  // But we'll allow specific origins for testing\n  const allowedOrigins = [\n    'https://github.com',\n    'https://api.github.com'\n  ];\n  \n  const origin = req.headers.origin;\n  if (allowedOrigins.includes(origin)) {\n    res.setHeader('Access-Control-Allow-Origin', origin);\n  }\n  \n  res.setHeader('Access-Control-Allow-Methods', 'POST');\n  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, X-GitHub-Event, X-GitHub-Delivery, X-Hub-Signature-256');\n  res.setHeader('Access-Control-Max-Age', '86400'); // 24 hours\n  \n  if (req.method === 'OPTIONS') {\n    return res.status(200).end();\n  }\n  \n  next();\n};\n\n/**\n * Error handling middleware for webhook endpoints\n */\nconst webhookErrorHandler = (error, req, res, next) => {\n  const { AuditLogger } = require('../utils/audit-logger');\n  \n  // Log the error\n  AuditLogger.logWebhookError({\n    eventType: req.headers['x-github-event'],\n    delivery: req.headers['x-github-delivery'],\n    error: error.message,\n    errorCode: error.code || 'WEBHOOK_ERROR',\n    ipAddress: req.ip,\n    userAgent: req.headers['user-agent'],\n    stackTrace: error.stack,\n    headers: req.headers\n  });\n  \n  // Determine status code\n  const statusCode = error.statusCode || error.status || 500;\n  \n  // Send error response\n  res.status(statusCode).json({\n    error: error.message || 'Internal server error',\n    code: error.code || 'INTERNAL_ERROR',\n    delivery: req.headers['x-github-delivery'],\n    timestamp: new Date().toISOString()\n  });\n};\n\n/**\n * Initialize all webhook middleware\n * @param {Object} config - Application configuration\n * @returns {Object} Middleware functions\n */\nconst initializeWebhookMiddleware = async (config) => {\n  const loadedConfig = config || await ConfigManager.loadConfig(process.env.NODE_ENV || 'production');\n  \n  return {\n    rateLimit: createWebhookRateLimit(loadedConfig),\n    security: createWebhookSecurity(),\n    requestLogger: webhookRequestLogger,\n    bodySizeValidator: webhookBodySizeValidator,\n    eventValidator: githubEventValidator,\n    cors: webhookCORS,\n    errorHandler: webhookErrorHandler\n  };\n};\n\nmodule.exports = {\n  createWebhookRateLimit,\n  createWebhookSecurity,\n  webhookRequestLogger,\n  webhookBodySizeValidator,\n  githubEventValidator,\n  webhookCORS,\n  webhookErrorHandler,\n  initializeWebhookMiddleware\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}